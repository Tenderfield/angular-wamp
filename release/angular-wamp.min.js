"use strict";function $WampProvider(){var a;return this.init=function(b){a=b||{}},this.$get=["$rootScope","$q",function(b,c){function d(a){return function(){var c=a.apply(this,arguments);return b.$apply(),c}}var e,f=[],g=c.defer(),h=function(a,c,d){return b.$broadcast("$wamp.onchallenge",{promise:g,session:a,method:c,extra:d}),g.promise};return a=angular.extend({onchallenge:h},a),e=new autobahn.Connection(a),e.onopen=function(a){b.$broadcast("$wamp.open",a);for(var d,e;f.length>0;)d=f.shift(),e=c.when(a[d.method].apply(a,d.args)),d.promise.resolve(e)},e.onclose=function(a,c){b.$broadcast("$wamp.close",{reason:a,details:c})},{connection:e,session:e.session,open:function(){e.open()},close:function(){e.close()},subscribe:function(a,b,g){if(b=d(b),!e.isOpen){var h=c.defer();return f.push({method:"subscribe",args:[a,b,g],promise:h}),h.promise}return c.when(e.session.subscribe(a,b,g))},unsubscribe:function(a){if(!e.isOpen){var b=c.defer();return f.push({method:"unsubscribe",args:arguments,promise:b}),b.promise}return c.when(e.session.unsubscribe(a))},publish:function(a,b,d,g){if(!e.isOpen){var h=c.defer();return f.push({method:"publish",args:arguments,promise:h}),h.promise}return c.when(e.session.publish(a,b,d,g))},register:function(a,b,g){if(b=d(b),!e.isOpen){var h=c.defer();return f.push({method:"register",args:[a,b,g],promise:h}),h.promise}return c.when(e.session.register(a,b,g))},call:function(a,b,d,g){if(!e.isOpen){var h=c.defer();return f.push({method:"call",args:arguments,promise:h}),h.promise}return c.when(e.session.call(a,b,d,g))}}}],this}var vxWampModule=angular.module("vxWamp",[]).provider("$wamp",$WampProvider);